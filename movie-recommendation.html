<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Movie Recommender</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen text-gray-800 font-sans flex flex-col">
  <div id="app" class="max-w-7xl mx-auto p-6 flex-grow">
    <header class="mb-10 text-center">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">ðŸŽ¬ Movie Recommender</h1>
      <p class="text-lg text-gray-600">Get personalized suggestions based on your preferences.</p>
    </header>

    <section class="mb-12">
      <div class="bg-white p-6 rounded-xl shadow-md">
        <h2 class="text-2xl font-semibold mb-4">How It Works</h2>
        <p class="mb-4 text-gray-700">We use a hybrid of content-based and collaborative filtering to generate recommendations based on what you like.</p>
        <ul class="list-disc pl-6 text-gray-700 space-y-1">
          <li>Genres you like are weighted and analyzed</li>
          <li>Movies are scored by similarity (70%) and rating (30%)</li>
          <li>Top results are recommended just for you</li>
        </ul>
      </div>
    </section>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Available Movies -->
      <div>
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-semibold">Browse Movies</h2>
          <select id="genre-select" class="border border-gray-300 rounded-lg px-3 py-2 bg-white shadow-sm"></select>
        </div>
        <div id="available-movies" class="bg-white rounded-xl shadow-md divide-y"></div>
      </div>

      <!-- Likes & Recommendations -->
      <div>
        <h2 class="text-xl font-semibold mb-4">Your Liked Movies</h2>
        <div id="liked-movies" class="bg-white rounded-xl shadow-md divide-y mb-8 p-4 min-h-[100px] text-gray-500 text-center">
          Like movies to see them here.
        </div>

        <h2 class="text-xl font-semibold mb-4">Recommended For You</h2>
        <div id="recommendations" class="bg-white rounded-xl shadow-md divide-y p-4 min-h-[100px] text-gray-500 text-center">
          Like movies to get personalized recommendations.
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center text-sm text-gray-500 py-4 mt-12">
    &copy; 2025 Alexander Huseby. All rights reserved.
  </footer>

  <!-- JavaScript -->
  <script>
    const movieDatabase = [
      { id: 1, title: "The Shawshank Redemption", year: 1994, genres: ["Drama"], rating: 9.3 },
      { id: 2, title: "The Godfather", year: 1972, genres: ["Crime", "Drama"], rating: 9.2 },
      { id: 3, title: "Pulp Fiction", year: 1994, genres: ["Crime", "Drama"], rating: 8.9 },
      { id: 4, title: "The Dark Knight", year: 2008, genres: ["Action", "Crime", "Drama"], rating: 9.0 },
      { id: 5, title: "Fight Club", year: 1999, genres: ["Drama"], rating: 8.8 },
      { id: 6, title: "Inception", year: 2010, genres: ["Action", "Adventure", "Sci-Fi"], rating: 8.8 },
      { id: 7, title: "The Matrix", year: 1999, genres: ["Action", "Sci-Fi"], rating: 8.7 },
      { id: 8, title: "Goodfellas", year: 1990, genres: ["Biography", "Crime", "Drama"], rating: 8.7 },
      { id: 9, title: "Interstellar", year: 2014, genres: ["Adventure", "Drama", "Sci-Fi"], rating: 8.6 },
      { id: 10, title: "The Silence of the Lambs", year: 1991, genres: ["Crime", "Drama", "Thriller"], rating: 8.6 },
      { id: 11, title: "Jurassic Park", year: 1993, genres: ["Adventure", "Sci-Fi", "Thriller"], rating: 8.1 },
      { id: 12, title: "Toy Story", year: 1995, genres: ["Animation", "Adventure", "Comedy"], rating: 8.3 },
      { id: 13, title: "Avatar", year: 2009, genres: ["Action", "Adventure", "Fantasy"], rating: 7.8 },
      { id: 14, title: "Titanic", year: 1997, genres: ["Drama", "Romance"], rating: 7.9 },
      { id: 15, title: "The Lion King", year: 1994, genres: ["Animation", "Adventure", "Drama"], rating: 8.5 },
      { id: 16, title: "Forrest Gump", year: 1994, genres: ["Drama", "Romance"], rating: 8.8 },
      { id: 17, title: "The Lord of the Rings: The Fellowship of the Ring", year: 2001, genres: ["Adventure", "Drama", "Fantasy"], rating: 8.8 },
      { id: 18, title: "Star Wars: Episode IV - A New Hope", year: 1977, genres: ["Action", "Adventure", "Fantasy"], rating: 8.6 },
      { id: 19, title: "The Avengers", year: 2012, genres: ["Action", "Adventure", "Sci-Fi"], rating: 8.0 },
      { id: 20, title: "The Green Mile", year: 1999, genres: ["Crime", "Drama", "Fantasy"], rating: 8.6 }
    ];
    let likedMovies = [];
    let availableMovies = [...movieDatabase];
    let recommendations = [];
    let selectedGenre = 'All';

    const genreSelect = document.getElementById('genre-select');
    const availableMoviesContainer = document.getElementById('available-movies');
    const likedMoviesContainer = document.getElementById('liked-movies');
    const recommendationsContainer = document.getElementById('recommendations');

    const allGenres = ['All', ...new Set(movieDatabase.flatMap(m => m.genres))].sort();

    function initApp() {
      allGenres.forEach(genre => {
        const option = document.createElement('option');
        option.value = genre;
        option.textContent = genre;
        genreSelect.appendChild(option);
      });

      genreSelect.addEventListener('change', (e) => {
        selectedGenre = e.target.value;
        updateAvailableMovies();
      });

      updateAvailableMovies();
    }

    function updateAvailableMovies() {
      if (selectedGenre === 'All') {
        availableMovies = movieDatabase.filter(movie => !likedMovies.includes(movie));
      } else {
        availableMovies = movieDatabase.filter(
          movie => movie.genres.includes(selectedGenre) && !likedMovies.includes(movie)
        );
      }
      renderAvailableMovies();
    }

    function renderAvailableMovies() {
      availableMoviesContainer.innerHTML = '';
      if (availableMovies.length === 0) {
        availableMoviesContainer.innerHTML = `<div class="p-4 text-center text-gray-500">No more movies${selectedGenre !== 'All' ? ` in ${selectedGenre}` : ''}.</div>`;
        return;
      }

      availableMovies.forEach(movie => {
        const el = document.createElement('div');
        el.className = 'p-4 flex justify-between items-center hover:bg-gray-50 transition';
        el.innerHTML = `
          <div>
            <h3 class="font-semibold">${movie.title} (${movie.year})</h3>
            <p class="text-sm text-gray-600">${movie.genres.join(', ')} Â· Rating: ${movie.rating}/10</p>
          </div>
          <button class="like-btn bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded" data-id="${movie.id}">Like</button>
        `;
        availableMoviesContainer.appendChild(el);
      });

      document.querySelectorAll('.like-btn').forEach(btn =>
        btn.addEventListener('click', () => handleLikeMovie(+btn.dataset.id))
      );
    }

    function handleLikeMovie(id) {
      const movie = movieDatabase.find(m => m.id === id);
      if (movie && !likedMovies.includes(movie)) {
        likedMovies.push(movie);
        updateAvailableMovies();
        renderLikedMovies();
        updateRecommendations();
      }
    }

    function handleRemoveLiked(id) {
      likedMovies = likedMovies.filter(m => m.id !== id);
      updateAvailableMovies();
      renderLikedMovies();
      updateRecommendations();
    }

    function renderLikedMovies() {
      likedMoviesContainer.innerHTML = likedMovies.length === 0
        ? '<p class="text-gray-500">Like movies to see them here.</p>'
        : '';

      likedMovies.forEach(movie => {
        const el = document.createElement('div');
        el.className = 'p-4 flex justify-between items-center hover:bg-gray-50 transition';
        el.innerHTML = `
          <div>
            <h3 class="font-semibold">${movie.title} (${movie.year})</h3>
            <p class="text-sm text-gray-600">${movie.genres.join(', ')}</p>
          </div>
          <button class="remove-btn bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded" data-id="${movie.id}">Remove</button>
        `;
        likedMoviesContainer.appendChild(el);
      });

      document.querySelectorAll('.remove-btn').forEach(btn =>
        btn.addEventListener('click', () => handleRemoveLiked(+btn.dataset.id))
      );
    }

    function generateRecommendations() {
      if (likedMovies.length === 0) return [];

      const genreCount = _.countBy(likedMovies.flatMap(m => m.genres));
      const maxGenreScore = Math.max(...Object.values(genreCount));

      return movieDatabase
        .filter(m => !likedMovies.includes(m))
        .map(m => {
          const genreScore = m.genres.reduce((acc, genre) => acc + (genreCount[genre] || 0), 0) / m.genres.length;
          const normalizedGenreScore = genreScore / (maxGenreScore || 1);
          const ratingScore = m.rating / 10;
          const finalScore = normalizedGenreScore * 0.7 + ratingScore * 0.3;
          return { ...m, score: finalScore };
        })
        .sort((a, b) => b.score - a.score)
        .slice(0, 5);
    }

    function renderRecommendations() {
      recommendationsContainer.innerHTML = recommendations.length === 0
        ? '<p class="text-gray-500">Like movies to get personalized recommendations.</p>'
        : '';

      recommendations.forEach(movie => {
        const el = document.createElement('div');
        el.className = 'p-4 hover:bg-gray-50 transition';
        el.innerHTML = `
          <div class="flex justify-between items-center">
            <h3 class="font-semibold">${movie.title} (${movie.year})</h3>
            <span class="text-sm bg-green-100 text-green-800 px-2 py-1 rounded">${(movie.score * 100).toFixed(0)}% match</span>
          </div>
          <p class="text-sm text-gray-600">${movie.genres.join(', ')} Â· Rating: ${movie.rating}/10</p>
        `;
        recommendationsContainer.appendChild(el);
      });
    }

    function updateRecommendations() {
      recommendations = generateRecommendations();
      renderRecommendations();
    }

    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>
